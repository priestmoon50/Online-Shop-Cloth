โ Summary: ุณุณุชู ุซุจุชโูุงู ู ูุฑูุฏ ุจุง ุชุฃุฏ ุงูู (Next.js Fullstack)
1. ุซุจุชโูุงู (Registration Flow)
๐ RegisterForm.tsx
ฺฏุฑูุชู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ: firstName, lastName, email, phone

ุงุนุชุจุงุฑุณูุฌ ฺฉูุงูุช (Client-side)

ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุจู API /api/auth/register

ูพุณ ุงุฒ ุซุจุช ููููุ ุงูุชูุงู ุจู ุตูุญู /verify-message?email=...

2. ุงุฑุณุงู ููฺฉ ุชุฃุฏ ุงูู
๐ /api/auth/register/route.ts
ุจุฑุฑุณ ุชฺฉุฑุงุฑ ูุจูุฏู email ุง phone

ุณุงุฎุช ุชูฺฉู ุชุฃุฏ verificationToken ุจุง crypto.uuid

ุฐุฎุฑู ฺฉุงุฑุจุฑ ุฏุฑ MongoDB ุจุง ููุฏ verified: false

ุงุฑุณุงู ุงูู ุชุฃุฏ ุจู ฺฉุงุฑุจุฑ ุจุง Resend API:

ููฺฉ: /verify?token=...

3. ููุงุด ูพุงู ุงูุชุธุงุฑ ุชุฃุฏ ุงูู
๐ verify-message/page.tsx
ุฏุฑุงูุช ุงูู ุงุฒ searchParams

ูพุงู: "ุงูู ุชุฃุฏ ุจุฑุง ุดูุง ุงุฑุณุงู ุดุฏ"

ูุงุจูุช ุงุฑุณุงู ูุฌุฏุฏ ุงูู ุจุง ุชุงูุฑ ฺฉ ุฏูููโุง

4. ุชุฃุฏ ุงูู ุจุง ููฺฉ
๐ verify/page.tsx
ฺฏุฑูุชู token ุงุฒ URL

ุฏุฑุฎูุงุณุช POST ุจู /api/auth/verify

ุชุบุฑ ููุฏ verified ุจู true ุฏุฑ ุฏุชุงุจุณ

ูพุงู ููููุช ุง ุดฺฉุณุช ุชุฃุฏ ุงูู

5. ูุฑูุฏ ุจุง ุงูู (ูุฑุญูู ุงูู)
๐ LoginForm.tsx
ฺฏุฑูุชู email

ุงุฑุณุงู ุฏุฑุฎูุงุณุช ุจู /api/auth/send-code

ูพุงู: "ฺฉุฏ ุชุฃุฏ ุจู ุงูู ุดูุง ุงุฑุณุงู ุดุฏ"

ุงูุชูุงู ุจู /verify-code?email=...

6. ุงุฑุณุงู ฺฉุฏ ุชุฃุฏ
๐ /api/auth/send-code/route.ts
ุจุฑุฑุณ ูุฌูุฏ ู ุชุฃุฏ ุจูุฏู ุงูู

ุชููุฏ ฺฉุฏ ถ ุฑูู (OTP) ู ุฐุฎุฑู ุฏุฑ MongoDB ุจุง expiresAt

ุงุฑุณุงู ุงูู ุญุงู ฺฉุฏ

7. ุชุฃุฏ ฺฉุฏ ู ุชููุฏ ุชูฺฉู
๐ VerifyCodeForm.tsx
ฺฏุฑูุชู email ู code ุงุฒ ฺฉุงุฑุจุฑ

ุงุฑุณุงู ุจู /api/auth/verify-code

๐ /api/auth/verify-code/route.ts
ุจุฑุฑุณ ูุฌูุฏ ุงูู ู ุตุญุช ฺฉุฏ

ุชููุฏ JWT ุจุง jsonwebtoken

ุจุฑฺฏุดุช ุชูฺฉู ุจู ฺฉูุงูุช

๐ ูุฑุญูู ุจุนุฏ (ุจุนุฏ ุงุฒ ุชุงุฏ ฺฉุฏ):
8. ูุฏุฑุช Session ุจุง LocalStorage ุง HttpOnly Cookie
ุฐุฎุฑู ุชูฺฉู ุฏุฑ localStorage ุจุฑุง 30 ุฑูุฒ

ุจุฑุฑุณ ุฏุฑ useEffect ฺฉู ุงฺฏุฑ ุชูฺฉู ูุนุชุจุฑ ูุฌูุฏ ุฏุงุฑุฏุ ฺฉุงุฑุจุฑ ุฑุง ูุงฺฏูโุดุฏู ูฺฏู ุฏุงุฑุฏ

ุณุงุฎุช Context ุจุฑุง ูุฏุฑุช authUser ุฏุฑ ฺฉู ูพุฑูฺู

๐งฉ ูุณุฑ ุงุฏุงูู:
ูุฑุญูู	ุชูุถุญ
โ ูุฑุญูู ุจุนุฏ	ุณุงุฎุช Context ุจุฑุง ุงุญุฑุงุฒ ููุช (AuthContext) ู ุฐุฎุฑู ุชูฺฉู
โ ุจุฑุฑุณ session ุฏุฑ ููุฏ ุงููู ุตูุญู (hydration)	
โณ ูุงุจูุช ุฎุฑูุฌ (Logout)	
โณ ูุญุงูุธุช ุงุฒ ูุณุฑูุง ุฎุตูุต (/account, /checkout)	
โณ ุงุฑุณุงู ุชูฺฉู ุฏุฑ Authorization header ุจู APIูุง	
โณ ุงูุฒูุฏู expiration ุจุฑุง session (ูุซูุงู 30 ุฑูุฒ)	
โณ ุงูุฒูุฏู ุตูุญู ูุฑุงููุด ุฑูุฒ ุจุง ุงุฑุณุงู ูุฌุฏุฏ ฺฉุฏ ุง ููฺฉ	

